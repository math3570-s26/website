{
  "hash": "aef7eb5b933f31ad638ec5241cfbc974",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Data Importing `<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M448 80v48c0 44.2-100.3 80-224 80S0 172.2 0 128V80C0 35.8 100.3 0 224 0S448 35.8 448 80zM393.2 214.7c20.8-7.4 39.9-16.9 54.8-28.6V288c0 44.2-100.3 80-224 80S0 332.2 0 288V186.1c14.9 11.8 34 21.2 54.8 28.6C99.7 230.7 159.5 240 224 240s124.3-9.3 169.2-25.3zM0 346.1c14.9 11.8 34 21.2 54.8 28.6C99.7 390.7 159.5 400 224 400s124.3-9.3 169.2-25.3c20.8-7.4 39.9-16.9 54.8-28.6V432c0 44.2-100.3 80-224 80S0 476.2 0 432V346.1z\"/></svg>`{=html}'\ntitle-slide-attributes:\n  data-background-image: ../images/bg.png\n  # data-background-size: stretch\n  # data-slide-number: none\nformat: \n  live-revealjs: \n    output-file: 08-import-slides.html\n    df-print: default\nwebr:\n  cell-options:\n    autorun: false\n  packages:\n    - tidyverse\nexecute: \n  echo: true\n---\n\n#  {visibility=\"hidden\"}\n\n\\def\\bx{\\mathbf{x}}\n\\def\\bg{\\mathbf{g}}\n\\def\\bw{\\mathbf{w}}\n\\def\\bbeta{\\boldsymbol \\beta}\n\\def\\bX{\\mathbf{X}}\n\\def\\by{\\mathbf{y}}\n\\def\\bH{\\mathbf{H}}\n\\def\\bI{\\mathbf{I}}\n\\def\\bS{\\mathbf{S}}\n\\def\\bW{\\mathbf{W}}\n\\def\\T{\\text{T}}\n\\def\\cov{\\mathrm{Cov}}\n\\def\\cor{\\mathrm{Corr}}\n\\def\\var{\\mathrm{Var}}\n\\def\\E{\\mathrm{E}}\n\\def\\bmu{\\boldsymbol \\mu}\n\\DeclareMathOperator*{\\argmin}{arg\\,min}\n\\def\\Trace{\\text{Trace}}\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n```\n:::\n\n\n# {background-color=\"#A7D5E8\" background-image=\"https://raw.githubusercontent.com/hadley/r4ds/main/diagrams/data-science/import.png\" background-size=\"contain\"}\n\n<!-- <h1>Importing</h1> -->\n\n\n# {background-color=\"#A7D5E8\"}\n\n![](https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/readr.png){width=\"180\"}![](https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/readxl.png){width=\"180\"}![](https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/haven.png){width=\"180\"}![](https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/rvest.png){width=\"180\"}![](./images/08-import/arrow.png){width=\"180\"}![](./images/08-import/vroom_logo.png){width=\"180\"}![](./images/08-import/datatable_logo.png){width=\"180\"}![](https://raw.githubusercontent.com/gesistsa/rio/main/man/figures/logo.svg){width=\"180\"}![](https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/googlesheets4.png){width=\"180\"}![](https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/sparklyr.png){width=\"180\"}\n<h3>DBI, jsonline, xml2, httr</h3> \n\n<h1>R Data Importing</h1>\n\n::: notes\n- There are tons of packages and tools out there, and there are lots of data file formats too. \n- Due to time limit, we will just cover commonly used tools and data file formats. And I think that should be enough for you to do your own project.\n- If you really need to import a data set that is stored in a very weird format, let me know. And we'll see how to solve this problem, maybe transform the format into another format. OK.\n- Here are the packages related to reading and writing files. We'll talk about some of them today.\n:::\n\n\n# {background-color=\"#A7D5E8\" background-image=\"https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/readr.png\" background-size=\"30%\" background-position=\"75% 50%\"}\n\n<a href=\"https://readr.tidyverse.org/\" style=\"position: absolute; inset: 0; display: block;\" aria-label=\"Readr website\"></a>\n\n\n::: {.left}\n<h1>Rectangular Data</h1>\n:::\n\n\n## [readr ðŸ“¦](https://readr.tidyverse.org/) Functions\n\n| Function  | Format                                           | Typical suffix |\n|-----------|--------------------------------------------------|:----------------:| \n| `read_table()`| white space separated values | txt |\n| `read_csv()` | comma separated values |  csv |\n| `read_csv2()` | semicolon separated values | csv |\n| `read_tsv()` | tab delimited separated values | tsv |\n| `read_fwf()` | fixed width files | txt |\n| `read_delim()` | general text file format, must define delimiter | txt |\n\n. . .\n\n:::{.alert}\n**Be careful**: The suffix usually tells us what type of file it is, but no guarantee that these always match. \n:::\n\n\n::: {.cell layout-align=\"center\" highlight.output='true'}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\nreadr::read_lines(\"./data/murders.csv\", n_max = 3)  ## there is a header\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"state,abb,region,population,total\" \"Alabama,AL,South,4779736,135\"     \n[3] \"Alaska,AK,West,710231,19\"         \n```\n\n\n:::\n:::\n\n\n::: notes\n- readr provides the following functions to read your data into R.\n- **Be careful**: The suffix usually tells us what type of file it is, but no guarantee that these always match. \n- If you don't want to open your data file, you can read several lines of your data in R using the function read_lines().\n- For example, I check the first three lines of the murders.csv file. And yes, it is a comma-separated-value or csv file. \n- Fixed width text files are special cases of text files where the format is specified by column widths, pad character and left/right alignment.  Column widths are measured in units of characters. For example, if you have data in a text file where the first column always has exactly 10 characters, and the second column has exactly 5, the third has exactly 12 (and so on), this would be categorized as a fixed width text file.\n:::\n\n\n## Reading Data\n\n`read_csv()` prints out a column specification giving us **delimiter**, **name** and **type** of each column.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\nmurders_csv <- read_csv(file = \"./data/murders.csv\")\n# Rows: 51 Columns: 5\n# â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n# Delimiter: \",\"\n# chr (3): state, abb, region\n# dbl (2): population, total\nhead(murders_csv)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 Ã— 5\n  state      abb   region population total\n  <chr>      <chr> <chr>       <dbl> <dbl>\n1 Alabama    AL    South     4779736   135\n2 Alaska     AK    West       710231    19\n3 Arizona    AZ    West      6392017   232\n4 Arkansas   AR    South     2915918    93\n5 California CA    West     37253956  1257\n6 Colorado   CO    West      5029196    65\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\n## View data in RStudio\nview(murders_csv)\n```\n:::\n\n\n::: notes\n- OK. Let's try to read the murders.csv file into R. We use read_csv(), and in the first argument, we tell R its file path. Your path is generally not the same as my path, so you get to change it to your path.\n- When we run `read_csv()`, it prints out a column specification that gives the **name** and **type** of each column.\n<!-- - You can see the data set is actually the one in the dslabs package, and we use it in a previous lab exercise, right? -->\n:::\n\n\n\n## Missing Values\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n::: {.question}\nWhich type is the column vector `x`? Why?\n:::\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/08-import/df-na.png){fig-align='center' width=100%}\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.fragment}\n\n- **Type coercion**^[A column with elements having different types, they'll be coerced to *the most flexible* type. Types from least to most flexible: *logical -- integer -- double -- character*.] happens and all column elements are transformed to character type. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nread_csv(\"./data/df-na.csv\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` my_class500\n# A tibble: 9 Ã— 3\n  x     y              z     \n  <chr> <chr>          <chr> \n1 1     a              hi    \n2 <NA>  b              hello \n3 3     Not applicable 9999  \n4 4     d              ola   \n5 5     e              hola  \n6 .     f              whatup\n7 7     g              wassup\n8 8     h              sup   \n9 9     i              <NA>  \n```\n\n\n:::\n:::\n\n:::\n:::\n\n::::\n\n::: notes\n- I have a csv file with 3 columns x, y, and z. \n- It looks like it should be some sort of numeric data. Right I have bunch of numbers here.\n- Character string NA, but that's just an NA. We have a period here, which is usually used as an NA as well.\n- But when we read this into R, we can see that it's being read as a character.\n- The reason is that the period which is a character shows up, and type coercion happens and all column elements are transformed to character type. \n- How to solve this kind of problem. We want x to be double and the period is actually a missing value. \n- Imaging that if you have thousands of lines, you could very easily miss that period. \n:::\n\n\n\n\n## Solution 1: Explicit NAs\n\n- By default, `read_csv()` only recognizes **\"  \"** and **NA** as a missing value.\n- Specify the values that are used to represent missing values by argument `na`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\nread_csv(\"./data/df-na.csv\", \n         na = c(\"\", \"NA\", \".\", \"9999\", \"Not applicable\"))\n```\n:::\n\n::::: {.columns}\n\n:::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/08-import/df-na.png){fig-align='center' width=90%}\n:::\n:::\n\n::::\n\n\n:::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n\n``` my_class500\n# A tibble: 9 Ã— 3\n      x y     z     \n  <dbl> <chr> <chr> \n1     1 a     hi    \n2    NA b     hello \n3     3 <NA>  <NA>  \n4     4 d     ola   \n5     5 e     hola  \n6    NA f     whatup\n7     7 g     wassup\n8     8 h     sup   \n9     9 i     <NA>  \n```\n\n\n:::\n:::\n\n::::\n:::::\n\n\n::: notes\n- The function recognize string NA as missing value, but not period or any other character or strings.\n- One solution is to specify explicitly the value (or values) that are used to represent missing values.\n- If you know what sort of character are used to denote missing values in your data file, you can give those as part of na argument in the read_csv() function.\n- For example here, I treat \"\", \"NA\", \".\", \"9999\", \"Not applicable\" all as missing values.\n- And now the class of x is double, and all those character strings are denoted as NA in the loaded data set.\n:::\n\n\n## Solution 2: Specify Column Types\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\nread_csv(\"./data/df-na.csv\", \n         col_types = cols(col_double(), \n                     col_character(), \n                     col_character()))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat <- vroom(...)\n  problems(dat)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n``` my_class500\n# A tibble: 9 Ã— 3\n      x y              z     \n  <dbl> <chr>          <chr> \n1     1 a              hi    \n2    NA b              hello \n3     3 Not applicable 9999  \n4     4 d              ola   \n5     5 e              hola  \n6    NA f              whatup\n7     7 g              wassup\n8     8 h              sup   \n9     9 i              <NA>  \n```\n\n\n:::\n:::\n\n:::\n\n\n\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\nproblems()\n# A tibble: 1 Ã— 5\n#     row   col expected actual file \n#   <int> <int> <chr>    <chr>  <chr>\n# 1     7     1 a double .      \"\" \n```\n:::\n\n:::\n::::\n\n\n::: notes\n- Another solution is to specify column types when you import your data.\n- This might be handy when you know what your column types should be.\n- For example, here I can specify the column types using the col_types argument. \n- All column types are wrapped up in the cols() command, that x is double, y is character and z is character as well.\n- Ans now you can see x becomes double. \n- And here we actually get a warning. In row 6 and col x, we expect a double but it is actually a dot or period, which is a character, and so R treats it as NA, which is exactly what I want to do. \n- But R send a message telling us about this, and make sure this is what we want to do.\n- This option might be preferable if you cannot scan your data file, or don;t know what convention is being used for missing values in your data file, but you happen to know your column types.\n- The downside of this is that, here, Not applicable and 9999, they are all treated as valid character values, and they are not missing values. So be careful about this. You may need to manually clean your data. \n:::\n\n\n\n## Column Types\n\n**type function**  | **data type**\n------------------ | -------------\n`col_character()`  | character\n`col_date()`       | date\n`col_datetime()`   | POSIXct (date-time)\n`col_double()`     | double (numeric)\n`col_factor()`     | factor\n`col_guess()`      | *let readr guess (default)*\n`col_integer()`    | integer\n`col_logical()`    | logical\n`col_number()`     | numbers mixed with non-number characters\n`col_numeric()`    | double or integer\n`col_skip()`       | do not read\n`col_time()`       | time\n\n\n\n\n::: notes\n- Here shows all possible column types you can use when importing your data into R. No need to memorize it. But just aware of them, and use them when you need to.\n:::\n\n## Writing Data {visibility=\"hidden\"}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\n## Create tibbles using a row-by-row layout\n(df <- tribble(\n  ~x, ~y,\n  1,  \"a\",\n  2,  \"b\",\n  3,  \"c\"\n))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 Ã— 2\n      x y    \n  <dbl> <chr>\n1     1 a    \n2     2 b    \n3     3 c    \n```\n\n\n:::\n\n```{.r .cell-code  code-line-numbers=\"false\"}\n## same as tibble(x = 1:3, y = c(a, b, c))\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\n## save data to \"./data/df.csv\"\ndf |> write_csv(file = \"./data/df.csv\")\n```\n:::\n\n\n\n::: notes\n- We can also write our data to a csv file as well. \n- Here I create a tibble called df, and then I use write_csv() function to write the data set df to the file df.csv.\n:::\n\n\n\n## Writing Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\nhead(iris, n = 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n```\n\n\n:::\n:::\n\n \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\n## save iris data to \"./data/iris.csv\"\niris |> write_csv(file = \"./data/iris.csv\")\ndf_iris <- read_csv(file = \"./data/iris.csv\")\ndf_iris\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 150 Ã— 5\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n         <dbl>       <dbl>        <dbl>       <dbl> <chr>  \n1          5.1         3.5          1.4         0.2 setosa \n2          4.9         3            1.4         0.2 setosa \n3          4.7         3.2          1.3         0.2 setosa \n4          4.6         3.1          1.5         0.2 setosa \n5          5           3.6          1.4         0.2 setosa \n6          5.4         3.9          1.7         0.4 setosa \n7          4.6         3.4          1.4         0.3 setosa \n8          5           3.4          1.5         0.2 setosa \n# â„¹ 142 more rows\n```\n\n\n:::\n:::\n\n\n\n\n\n\n## Check Files using **fs** Package [![](https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/fs.png){width=60}](https://github.com/r-lib/fs) {visibility=\"hidden\"}\n\n\n::: {.cell layout-align=\"center\" highlight.output='7'}\n\n```{.r .cell-code}\n# install.packages(\"fs\")\n# library(fs)\nfs::dir_ls(path = \"./data\") |> head(15)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` my_class600\n./data/2010_bigfive_regents.xls\n./data/Batting.csv\n./data/BodyData.txt\n./data/HRlist2.txt\n./data/OnlyTitanic.xlsx\n./data/People.csv\n./data/RD-Mortality-Report_2015-18-180531.pdf\n./data/Salaries.csv\n./data/USArrests.csv\n./data/approval_topline.csv\n./data/bdiag.csv\n./data/bikeshare-day.csv\n./data/body.csv\n./data/carbon_emissions.csv\n./data/cars.rds\n```\n\n\n:::\n:::\n\n\n\n::: notes\n- You can fs package to do file system operations directly in R, so you don't need to do operations in your bash or zsh in terminal.\n- Here I list all files stored in the data folder, and make sure that df.csv is there. \n:::\n\n\n## `read_rds()` and `write_rds()` {visibility=\"hidden\"}\n- We save an R object (usually a data set) in `.Rds` in the R binary file format. ^[Check R built-in data sets using command `data()`.]\n\n\n::: {.cell layout-align=\"center\" highlight.output='1'}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\nreadr::write_rds(cars, \n                 file = \"./data/cars.rds\") \n# fs::dir_ls(path = \"./data\") |> head(10)\n```\n:::\n\n\n<br>\n\n. . .\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\nmy_car <- readr::read_rds(file = \"./data/cars.rds\") \nhead(my_car, 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  speed dist\n1     4    2\n2     4   10\n3     7    4\n```\n\n\n:::\n:::\n\n\n\n::: notes\n- We save an R object (usually a data set) in `.Rds`m the R binary file format.\n- Remember we talked about RData format last time, right?\n- R provides two file formats of its own for storing data, .RDS and .RData. RDS files can store a single R object, and RData files can store multiple R objects.\n- Usually, if we save a data set, we use .Rds, and if we save several objects, and the objects are some variables or functions, we use .RData.\n- Read the data back into R.\n:::\n\n\n##\n\n:::{.lab}\n<span style=\"color:blue\"> **10-Import Data** </span>\n\n<!-- - Create a R script named **lab08-importdata.R** -->\n\n- If you haven't, install and load the `tidyverse` package.\n\nIn **lab.qmd** `## Lab 10` section,\n<!-- - If you haven't, upload data.zip posted in D2L Week 5 module to your lab project workspace. -->\n<!-- - Run the following code to see the data sets saved in the `dslabs` package: -->\n<!-- ```{r, eval=FALSE} -->\n<!-- path <- system.file(\"extdata\", package = \"dslabs\") -->\n<!-- files <- list.files(path) -->\n<!-- files -->\n<!-- ``` -->\n<!-- - Use `file.path()` to create the file path for the file **\"ssa-death-probability.csv\"**.  -->\n\n\n- Import **ssa_male_prob.csv** in the data folder using `read_csv()` and call it `ssa_male`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\nssa_male <- readr::read____(____________)\n```\n:::\n\n\n- Plot `Age` (x-axis) vs. `LifeExp` (y-axis). The type is \"line\", and the line color is blue. Add x-label, y-label and title to your plot.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\nplot(x = _____, y = _____, type = ______, col = ______,\n     xlab = ______, ylab = _______, main = ____________)\n```\n:::\n\n\n<!-- - Use `lines()` to add a line of `Age` (x-axis) vs. `LifeExp` (y-axis) for `Male` to the plot. The color is blue. -->\n\n<!-- ```{r} -->\n<!-- #| eval: false -->\n<!-- #| purl: false -->\n<!-- #| code-line-numbers: false -->\n<!-- lines(x = _____, y = _____, col = ______) -->\n<!-- ``` -->\n\n- Save the data `penguins_raw` in the R [`palmerpenguins` package](https://allisonhorst.github.io/palmerpenguins/) to \"./data/penguins_df.csv\". Print `penguins_df.csv` out.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\n_________(palmerpenguins)\nwrite______()\npenguins_df\n```\n:::\n\n\n\n:::\n\n\n::: notes\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nssa <- read_csv(file = \"./data/ssa-death-probability.csv\")\nssa_male <- ssa[ssa$Sex == \"Male\", ]\nssa_female <- ssa[ssa$Sex == \"Female\", ]\nplot(x = ssa_female$Age, y = ssa_female$LifeExp, \n     type = \"l\", col = 2, lwd = 3,\n     xlab = \"Age\", ylab = \"Life Exp\",\n     main = \"Age vs. Life Exp by Gender\")\nlines(ssa_male$Age, ssa_male$LifeExp, col = 4, lwd = 3)\n```\n:::\n\n:::\n\n\n\n# {background-color=\"#A7D5E8\" background-image=\"https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/readxl.png\" background-size=\"30%\" background-position=\"70% 50%\"}\n\n<a href=\"https://readxl.tidyverse.org/\" style=\"position: absolute; inset: 0; display: block;\" aria-label=\"arrow website\"></a>\n\n::: {.left}\n<h1>Read Excel Data</h1>\n:::\n\n::: notes\n- Last time, we use the readr package to import our data into R, right?\n- What if you have a data set stored in microsoft excel, well we can use read excel package to read your data.\n:::\n\n\n## [readxl ðŸ“¦](https://readxl.tidyverse.org/) Functions\n\n| Function  | Format                                           | Typical suffix |\n|-----------|--------------------------------------------------|:----------------:| \n| `read_excel()` | auto detect the format | xls, xlsx|\n| `read_xls()` | original format |  xls |\n| `read_xlsx()` | new format | xlsx |\n\n- The Microsoft Excel can have more than one sheet in one file. \n- The functions above read the **first** sheet by default.\n- The `excel_sheets()` gives us the names of all the sheets in an Excel file.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\nlibrary(readxl)\nexcel_sheets(\"./data/2010_bigfive_regents.xls\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Sheet1\" \"Sheet2\" \"Sheet3\"\n```\n\n\n:::\n:::\n\n\n::: notes\n- Here shows the main read excel functions. They are pretty similar to readr functions, but this time, your data file is not a text file, but a microsoft excel file.\n- The Microsoft Excel can have more than one sheet in one file. \n- The functions listed above read the **first **sheet by default.\n- If you don't want open your excel file and check its sheet names, the `excel_sheets()` function gives us the names of all the sheets in an Excel file.\n:::\n\n\n## Sheet Names\n\n- The sheet names can be passed to the `sheet` argument to read sheets other than the first.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\nexcel_sheets(\"./data/2010_bigfive_regents.xls\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Sheet1\" \"Sheet2\" \"Sheet3\"\n```\n\n\n:::\n\n```{.r .cell-code  code-line-numbers=\"false\"}\n(data_xls <- read_xls(path = \"./data/2010_bigfive_regents.xls\", \n                      sheet = \"Sheet3\", \n                      skip = 1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 19 Ã— 6\n  Scores `131024` `113804` `104201` `103886` `91756`\n   <dbl>    <dbl>    <dbl>    <dbl>    <dbl>   <dbl>\n1     10       NA       64        8      227      34\n2     11        6       83       11      217      58\n3     12       23       87        7       28      67\n4     13        1       54       16      230      42\n5     14        3      145       18      303      57\n6     15       58      151       50      192      98\n7     16        1      129       13      156     125\n8     17       73      214       59      163     115\n# â„¹ 11 more rows\n```\n\n\n:::\n:::\n\n\n::: notes\n- The sheet names can be passed to the `sheet` argument in the functions to read sheets other than the first.\n- For example, here we ask R to read the Sheet1 in the favourite-food excel file.\n- We can also specify an integer that indicates the position of the sheet.\n- We don't have a lab exercise on this. You have data and code is right here. You can practice and see if you can read the excel file.\nrange = cell_rows(102:151)\n:::\n\n\n\n\n# {background-color=\"#ffde57\" background-image=\"https://upload.wikimedia.org/wikipedia/commons/e/ed/Pandas_logo.svg\" background-size=\"40%\" background-position=\"70% 50%\"}\n\n\n<a href=\"https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html\" style=\"position: absolute; inset: 0; display: block;\" aria-label=\"arrow website\"></a>\n\n\n::: {.left}\n<h2>`pd.read_csv`</h2>\n<!-- <h2>`pd.read_excel`</h2> -->\n<h2>`pd.DataFrame.to_csv`</h2>\n:::\n\n## `pd.read_csv`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code  code-line-numbers=\"false\"}\nimport numpy as np\nimport pandas as pd\n\npy_df = pd.read_csv('./data/murders.csv')\nprint(py_df.head())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        state abb region  population  total\n0     Alabama  AL  South     4779736    135\n1      Alaska  AK   West      710231     19\n2     Arizona  AZ   West     6392017    232\n3    Arkansas  AR  South     2915918     93\n4  California  CA   West    37253956   1257\n```\n\n\n:::\n:::\n\n\n\n## `pd.DataFrame.to_csv`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code  code-line-numbers=\"false\"}\nw = {\"x\":[1, 2, 3], \n     \"y\":['a', 'b','c']}\nwdf = pd.DataFrame(w)\n\nwdf.to_csv(\"./data/wdf.csv\")\nmydf = pd.read_csv('./data/wdf.csv')\nprint(mydf.head())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Unnamed: 0  x  y\n0           0  1  a\n1           1  2  b\n2           2  3  c\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code  code-line-numbers=\"false\"}\n## index = False means don't write row names\nwdf.to_csv(\"./data/wdf.csv\", index = False)\nmydf = pd.read_csv('./data/wdf.csv')\nprint(mydf.head())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   x  y\n0  1  a\n1  2  b\n2  3  c\n```\n\n\n:::\n:::\n\n\n\n<!-- ## `pd.read_excel` {visibility=\"hidden\"} -->\n\n<!-- :::{.callout-warning} -->\n\n<!-- :::{style=\"font-size: 1.2em;\"} -->\n<!-- [`pd.read_excel()`](https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html) needs other libraries installed. -->\n\n<!-- -  `openpyxl` for `.xlsx` format -->\n<!-- -  `xlrd` for `xls` format -->\n<!-- - `py_install(\"xlrd\")` in R or `pip install pandas` or `conda install pandas` in the terminal. -->\n<!-- ::: -->\n\n<!-- ::: -->\n\n<!-- ```{r} -->\n<!-- #| echo: false -->\n<!-- py_install(\"xlrd\") -->\n<!-- ``` -->\n\n<!-- ```{python} -->\n<!-- df_x = pd.read_excel('./data/2010_bigfive_regents.xls', engine='xlrd', -->\n<!-- sheet_name=\"Sheet3\", skiprows=1) -->\n<!-- df_x.head() -->\n<!-- ``` -->\n\n\n<!-- ::: notes -->\n<!-- ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl. -->\n<!-- https://stackoverflow.com/questions/65250207/pandas-cannot-open-an-excel-xlsx-file -->\n<!-- ::: -->\n\n\n<!-- # Other Importing Methods* -->\n\n\n\n##\n\n::: genai\n\n<span style=\"color:green\"> **10-Import Data** </span>\n\n> `>` I have a R object that cannot be saved as a csv or excel file, for example, a list. How can I save that object, and reuse it later? Please teach me with a simple example.\n\n\n<br>\n\n- Share what you learned from AI!~\n\n\n:::\n\n::: notes\nWhen NOT to use CSV/Excel\nObjects with nested structures (lists, models, tibbles with list-columns).\nData requiring preservation of attributes (factor levels, classes like Date, POSIXct, sf, etc.).\n:::\n\n\n# {background-color=\"\" background-image=\"./images/08-import/arrow.png\" background-size=\"30%\" background-position=\"70% 50%\"}\n\n<a href=\"https://arrow.apache.org/\" style=\"position: absolute; inset: 0; display: block;\" aria-label=\"arrow website\"></a>\n\n::: {.left}\n<!-- <h2>Fast Reading and Writing</h2> -->\n<!-- <h2>Data Format in R and Python*</h2> -->\n\n<h1>Big Data*</h1> \n:::\n\n## [Apache Arrow](https://arrow.apache.org/) for [R](https://arrow.apache.org/docs/r/) and [Python](https://arrow.apache.org/docs/python/)\n\n- Apache Arrow develops big data systems to process and move data fast.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/08-import/speed.png){fig-align='center' width=100%}\n:::\n:::\n\n\n<!-- - Arrow -->\n\n<!--   + allows users to read and write data in a variety formats -->\n<!--   + provides data analysis tools for both in-memory and larger-than-memory data sets -->\n<!--   + provides access to remote filesystems and servers -->\n<!--   + zero-copy data sharing between R and Python -->\n\n<!-- - [R package](https://arrow.apache.org/docs/r/) -->\n<!-- ```{r} -->\n<!-- #| eval: false -->\n<!-- install.packages(\"arrow\") -->\n<!-- library(arrow) -->\n<!-- ``` -->\n\n<!-- - [Python package](https://arrow.apache.org/docs/python/) -->\n\n<!-- ```bash -->\n<!-- pip install pyarrow -->\n<!-- ``` -->\n\n<!-- ```{python} -->\n<!-- #| eval: false -->\n<!-- import pyarrow as pa -->\n<!-- ``` -->\n\n\n\n\n\n<!-- ## feather ðŸ“¦ {visibility=\"hidden\"} -->\n\n<!-- - [**feather**](https://github.com/wesm/feather) is a binary file format for storing data frames. -->\n<!--   + **Lightweight**: file size is smaller than CSV files (but larger than R native binary .Rds/.RData files) -->\n<!--   + **Language agnostic**: feather files are the same in R and Python -->\n<!--   + **High read and write performance**: faster than `read_csv()` and `read_rds()`. -->\n\n\n<!-- ```{r} -->\n<!-- #| label: feather -->\n<!-- #| purl: false -->\n\n<!-- library(feather) -->\n<!-- challenge <- read_csv(file = readr_example(\"challenge.csv\"), -->\n<!--                       col_types = readr::cols(x = readr::col_double(),  -->\n<!--                                               y = readr::col_date())) -->\n<!-- # It is a `.feather` file -->\n<!-- feather::write_feather(x = challenge,  -->\n<!--                        path = \"./data/challenge.feather\") -->\n<!-- ``` -->\n\n\n<!-- ## Read `.feather` Data in Python {visibility=\"hidden\"} -->\n\n<!-- ```{r} -->\n<!-- #| echo: false -->\n<!-- reticulate::py_install(\"pyarrow\") -->\n<!-- ``` -->\n\n<!-- ```{python} -->\n<!-- ## Need to install PyArrow package  -->\n<!-- import pyarrow.feather as feather -->\n\n<!-- py_feather_df = feather.read_feather(\"./data/challenge.feather\") -->\n<!-- py_feather_df.head() -->\n<!-- ``` -->\n\n\n<!-- ## How Fast is feather ?! {visibility=\"hidden\"} -->\n\n<!-- ```{r, purl=FALSE} -->\n<!-- ## Unit: seconds -->\n<!-- ##                  expr   min    lq       mean median    uq   max neval -->\n<!-- ## readr::read_csv()      27.0  28.0  29.770890   29.0  32.0  33.0    10 -->\n<!-- ## base::readRDS()         4.6   4.7   5.053674    5.1   5.3   5.6    10 -->\n<!-- ## feather::read_feather   1.5   1.8   2.988021    3.4   3.6   4.1    10 -->\n<!-- ``` -->\n\n\n<!-- # {background-color=\"#A7D5E8\"} {visibility=\"hidden\"} -->\n\n<!-- ![](https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/haven.png){width=\"180\"}![](https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/rvest.png){width=\"180\"}![](./images/08-import/vroom_logo.png){width=\"180\"}![](./images/08-import/datatable_logo.png){width=\"180\"}![](./images/08-import/rio_logo.png){width=\"180\"}![](https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/googlesheets4.png){width=\"180\"}![](https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/sparklyr.png){width=\"180\"} -->\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}